<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>
    Davide Modesto
    </title><!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Berghain Challenge" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The Problem This challenge is inspired by the Berghain Challenge, originally promoted by Listen Lab. In it, you play the role of a nightclub bouncer tasked with filling 1,000 spots while satisfying strict demographic constraints‚Äîlike ensuring at least 40% Berlin locals, 80% wearing black, and so on. The twist? Guests arrive one by one, and you must make immediate accept or reject decisions with no second chances. Your goal is to meet all constraints while rejecting as few people as possible." />
<meta property="og:description" content="The Problem This challenge is inspired by the Berghain Challenge, originally promoted by Listen Lab. In it, you play the role of a nightclub bouncer tasked with filling 1,000 spots while satisfying strict demographic constraints‚Äîlike ensuring at least 40% Berlin locals, 80% wearing black, and so on. The twist? Guests arrive one by one, and you must make immediate accept or reject decisions with no second chances. Your goal is to meet all constraints while rejecting as few people as possible." />
<link rel="canonical" href="http://localhost:4000/berghain-challenge/" />
<meta property="og:url" content="http://localhost:4000/berghain-challenge/" />
<meta property="og:site_name" content="ElModdy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-09-15T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Berghain Challenge" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-09-15T00:00:00+02:00","datePublished":"2025-09-15T00:00:00+02:00","description":"The Problem This challenge is inspired by the Berghain Challenge, originally promoted by Listen Lab. In it, you play the role of a nightclub bouncer tasked with filling 1,000 spots while satisfying strict demographic constraints‚Äîlike ensuring at least 40% Berlin locals, 80% wearing black, and so on. The twist? Guests arrive one by one, and you must make immediate accept or reject decisions with no second chances. Your goal is to meet all constraints while rejecting as few people as possible.","headline":"Berghain Challenge","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/berghain-challenge/"},"url":"http://localhost:4000/berghain-challenge/"}</script>
<!-- End Jekyll SEO tag -->
<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="ElModdy" /><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>
    <script src="/assets/js/mathjax-config.js"></script>

    <link rel="shortcut icon" type="image/x-icon" href="" />
    <link rel="stylesheet" href="/assets/css/main.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.css" integrity="sha384-OH8qNTHoMMVNVcKdKewlipV4SErXqccxxlg6HC9Cwjr5oZu2AdBej1TndeCirael" crossorigin="anonymous">

</head><body a="auto">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <a href="/"></a><article>
  <p class="post-meta">
    <time datetime="2025-09-15 00:00:00 +0200">2025-09-15 00:00:00 +0200</time>
  </p>
  
  <h1>Berghain Challenge</h1>

  <h2 id="the-problem">The Problem</h2>
<p>This challenge is inspired by the <a href="https://berghain.challenges.listenlabs.ai/">Berghain Challenge</a>, originally promoted by <a href="https://www.linkedin.com/company/listenlabss/about/">Listen Lab</a>. In it, you play the role of a nightclub bouncer tasked with filling 1,000 spots while satisfying strict demographic constraints‚Äîlike ensuring at least 40% Berlin locals, 80% wearing black, and so on.<br /><br />
The twist? Guests arrive one by one, and you must make immediate accept or reject decisions with no second chances. Your goal is to meet all constraints while rejecting as few people as possible.</p>

<h2 id="results">Results</h2>
<p>I first enrolled as ‚ÄúDavide Modesto,‚Äù but realized that being scarce on <a href="https://www.linkedin.com/in/davide-m-561915128">LinkedIn</a> and <a href="https://www.instagram.com/davidemodesto_/">Instagram</a> meant nobody would contact me. With only 25 characters for a name, I combined the reason people might reach me and an email into:
<strong><code class="language-plaintext highlighter-rouge">looking4job.orphd@gmx.at</code></strong>.<br />
Regretted it immediately, but too late.
<br />
Now to the actual numbers (remember: <strong>lower = better</strong>):
<br /></p>
<ul>
  <li><strong>1st place</strong>: 7,609</li>
  <li><strong>Me</strong>: 8,092</li>
  <li><strong>GPT-5-pro</strong>: 24,913
<br /></li>
</ul>

<p>So yes, I actually did beat GPT-5-pro. I ended up in <strong>38nd place</strong>, and I‚Äôm genuinely proud of that, especially because my approach was just a minimal, lightweight algorithm that can run on a laptop, with no machine-learning machinery in sight.</p>

<h2 id="mathematical-framework">Mathematical Framework</h2>
<p>Let $F$ be the set of binary features we care about (e.g. {local/tourist, black outfit/other, young/old}). Each candidate is represented as a binary feature vector $X_n \in \{0,1\}^{|F|}$, where each coordinate represents presence or absence of a feature. These candidates arrive i.i.d. from some unknown distribution $\mu$.<br /><br />
The challenge provides marginal probabilities and pairwise correlations, but this information doesn‚Äôt uniquely determine the joint distribution for $|F| &gt; 2$. To resolve this, I estimated an empirical distribution $\mu_{\text{init}}$ from initial gameplay, then solved an optimization problem minimizing KL divergence from $\mu_{\text{init}}$ subject to the given marginal and correlation constraints.</p>

<h2 id="decision-policy">Decision Policy</h2>
<p>Our strategy is a stochastic policy $a:\{0,1\}^{|F|} \rightarrow [0,1]$, where $a(x)$ represents the probability of accepting a candidate with feature vector $x$. For the $n$-th candidate with features $X_n = x$, our decision $A_n \in \{0,1\}$ satisfies:
\(\Pr(A_n = 1 | X_n = x) = a(x)\)</p>

<h2 id="the-core-optimization-problem">The Core Optimization Problem</h2>
<p>The idea is to strategically vary $a$ to ‚Äústeer‚Äù the demographics of accepted candidates toward the required constraints while minimizing rejections.
<br />
To frame this mathematically, let‚Äôs introduce:<br /><br />
<strong>Acceptance Time $\tau(a)$:</strong> The number of candidates we must see until we accept one:
\(\tau(a) := \inf\{k \geq 1: A_k = 1\}\)</p>

<p><strong>Accepted Candidate $Y(a)$:</strong> The feature vector of the candidate we actually accept:
\(Y(a) := X_{\tau(a)}\)
Now we can state the idea mathematically as follows.<br />
At any point with $N$ remaining spots and $c_i$ missing people with feature $i$, we want to solve:</p>

\[\begin{aligned}
&amp;\text{minimize} &amp;&amp; \mathbb{E}[\tau(a)]\\
&amp;\text{subject to} &amp;&amp; N \cdot \mathbb{E}[(Y(a))_i] \geq c_i \quad \text{for } i=1,\ldots,|F|
\end{aligned}\]

<h2 id="computing-the-distribution-of-taua">Computing the Distribution of $\tau(a)$</h2>
<p>The probability of accepting any given candidate is
\(Z(a) := \Pr(A_n(a)=1) = \sum_{x\in S}\mu(x)a(x).\)
For each integer $k\ge1$,
\(\begin{aligned}
\Pr(\tau(a)=k)
&amp;= \prod_{n=1}^{k-1} \Pr(A_n=0)\Pr(A_k=1) \\
&amp;= (1-Z(a))^{k-1}Z(a).
\end{aligned}\)</p>

<p>Thus $\tau(a)$ follows a geometric distribution with parameter $Z(a)$, so its expected value is $\mathbb{E}[\tau(a)]=\frac{1}{Z(a)}$.</p>
<h2 id="computing-the-distribution-of-ya">Computing the Distribution of $Y(a)$</h2>
<p>Now we can calculate the distribution of $Y(a)$
\(\begin{align}
\Pr(Y(a) = x) &amp;= \sum_{k=1}^{\infty} \Pr(\tau(a) = k, X_k = x) \\
&amp;= \sum_{k=1}^{\infty} \Pr(X_k = x, A_k = 1) \prod_{j=1}^{k-1} \Pr(A_j = 0) \\
&amp;= \sum_{k=1}^{\infty} \mu(x) a(x) (1-Z(a))^{k-1} \\
&amp;= \frac{\mu(x) a(x)}{Z(a)}
\end{align}\)</p>

<p>Therefore: \(\mathbb{E}[(Y(a))_i] = \sum_{x: x_i = 1} \frac{\mu(x) a(x)}{Z(a)}\).</p>

<h2 id="the-complete-reformulation">The Complete Reformulation</h2>
<p>Now we can substitute our computed expectations back into the original problem:</p>

\[\begin{aligned}
&amp;\text{maximize} &amp;&amp; \sum_{x \in \{0,1\}^{|F|}} \mu(x) a(x) \\
&amp;\text{subject to} &amp;&amp; N \sum_{x: x_i = 1} \mu(x) a(x) \geq c_i \sum_{x \in \{0,1\}^{|F|}} \mu(x) a(x) \quad \text{for } i=1,\ldots,|F|\\
&amp;&amp; &amp; 0 \leq a(x) \leq 1 \quad \text{for all } x \in \{0,1\}^{|F|}
\end{aligned}\]

<h2 id="implementation">Implementation</h2>
<p>Here‚Äôs the GitHub link üôÉ <a href="https://github.com/ElModdy/listenlab-challenge">GitHub Repository</a>.
Honestly, an AI could probably fill in the implementation from this post, minor tweaks aside, it‚Äôs all there.</p>

<p>For some extra luck running multiple simulations, I ended up using <strong>GitHub Actions</strong>: free, fast, and surprisingly perfect for the job.</p>

</article>
      </div>
    </main>
  </body>
</html>